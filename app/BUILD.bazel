# TODO(#1532): Rename file to 'BUILD' post-Gradle.
'''
This library contains the app's core source files and functionality
'''
load("@rules_jvm_external//:defs.bzl", "artifact")
load("@dagger//:workspace_defs.bzl", "dagger_rules")
load("@tools_android//tools/crashlytics:defs.bzl", "crashlytics_android_library")
load("@tools_android//tools/googleservices:defs.bzl", "google_services_xml")
load("@io_bazel_rules_kotlin//kotlin:kotlin.bzl", "kt_android_library")
load("//app:app_test.bzl", "app_test")

# Source files for annotations library.
ANNOTATIONS = [
    "src/main/java/org/oppia/app/activity/ActivityScope.kt",
    "src/main/java/org/oppia/app/fragment/FragmentScope.kt",
    "src/main/java/org/oppia/app/utility/KeyboardHelper.kt",
]

# Source files for listener library.
LISTENERS = [
    "src/main/java/org/oppia/app/administratorcontrols/RouteToAppVersionListener.kt",
    "src/main/java/org/oppia/app/administratorcontrols/RouteToProfileListListener.kt",
    "src/main/java/org/oppia/app/drawer/RouteToProfileProgressListener.kt",
    "src/main/java/org/oppia/app/help/faq/RouteToFAQSingleListener.kt",
    "src/main/java/org/oppia/app/help/RouteToFAQListListener.kt",
    "src/main/java/org/oppia/app/home/recentlyplayed/OngoingStoryClickListener.kt",
    "src/main/java/org/oppia/app/home/RouteToRecentlyPlayedListener.kt",
    "src/main/java/org/oppia/app/home/RouteToTopicPlayStoryListener.kt",
    "src/main/java/org/oppia/app/home/topiclist/TopicSummaryClickListener.kt",
    "src/main/java/org/oppia/app/onboarding/OnboardingListener.kt",
    "src/main/java/org/oppia/app/onboarding/RouteToProfileListListener.kt",
    "src/main/java/org/oppia/app/options/RouteToAppLanguageListListener.kt",
    "src/main/java/org/oppia/app/options/RouteToAudioLanguageListListener.kt",
    "src/main/java/org/oppia/app/options/RouteToStoryTextSizeListener.kt",
    "src/main/java/org/oppia/app/player/audio/LanguageInterface.kt",
    "src/main/java/org/oppia/app/player/state/answerhandling/InteractionAnswerErrorOrAvailabilityCheckReceiver.kt",
    "src/main/java/org/oppia/app/player/state/answerhandling/InteractionAnswerHandler.kt",
    "src/main/java/org/oppia/app/player/state/listener/ContinueNavigationButtonListener.kt",
    "src/main/java/org/oppia/app/player/state/listener/NextNavigationButtonListener.kt",
    "src/main/java/org/oppia/app/player/state/listener/PreviousNavigationButtonListener.kt",
    "src/main/java/org/oppia/app/player/state/listener/PreviousResponsesHeaderClickListener.kt",
    "src/main/java/org/oppia/app/player/state/listener/ReplayButtonListener.kt",
    "src/main/java/org/oppia/app/player/state/listener/ReturnToTopicNavigationButtonListener.kt",
    "src/main/java/org/oppia/app/player/state/listener/RouteToHintsAndSolutionListener.kt",
    "src/main/java/org/oppia/app/player/state/listener/StateKeyboardButtonListener.kt",
    "src/main/java/org/oppia/app/player/state/listener/SubmitNavigationButtonListener.kt",
    "src/main/java/org/oppia/app/profile/RouteToAdminPinListener.kt",
    "src/main/java/org/oppia/app/profileprogress/ProfilePictureClickListener.kt",
    "src/main/java/org/oppia/app/profileprogress/RouteToCompletedStoryListListener.kt",
    "src/main/java/org/oppia/app/profileprogress/RouteToOngoingTopicListListener.kt",
    "src/main/java/org/oppia/app/recyclerview/OnDragEndedListener.kt",
    "src/main/java/org/oppia/app/recyclerview/OnItemDragListener.kt",
    "src/main/java/org/oppia/app/story/ExplorationSelectionListener.kt",
    "src/main/java/org/oppia/app/topic/lessons/StorySummarySelector.kt",
    "src/main/java/org/oppia/app/topic/revision/RevisionSubtopicSelector.kt",
    "src/main/java/org/oppia/app/topic/revisioncard/ReturnToTopicClickListener.kt",
    "src/main/java/org/oppia/app/topic/RouteToRevisionCardListener.kt",
    "src/main/java/org/oppia/app/utility/OnClickableAreaClickedListener.kt",
    "src/main/java/org/oppia/app/utility/RegionClickEvent.kt",
    "src/main/java/org/oppia/app/walkthrough/end/WalkthroughEndPageChanger.kt",
    "src/main/java/org/oppia/app/walkthrough/WalkthroughActivityListener.kt",
    "src/main/java/org/oppia/app/walkthrough/WalkthroughFragmentChangeListener.kt",
    "src/main/java/org/oppia/app/walkthrough/WalkthroughPageChanger.kt",
]

# Layout files for databinding_resources library.
LAYOUTS = ["src/main/res/layout*/**"]

# Source files for view_model library
VIEW_MODELS = [
    "src/main/java/org/oppia/app/administratorcontrols/administratorcontrolsitemviewmodel/AdministratorControlsAppInformationViewModel.kt",
    "src/main/java/org/oppia/app/administratorcontrols/administratorcontrolsitemviewmodel/AdministratorControlsDownloadPermissionsViewModel.kt",
    "src/main/java/org/oppia/app/administratorcontrols/administratorcontrolsitemviewmodel/AdministratorControlsGeneralViewModel.kt",
    "src/main/java/org/oppia/app/administratorcontrols/administratorcontrolsitemviewmodel/AdministratorControlsItemViewModel.kt",
    "src/main/java/org/oppia/app/administratorcontrols/administratorcontrolsitemviewmodel/AdministratorControlsProfileViewModel.kt",
    "src/main/java/org/oppia/app/administratorcontrols/AdministratorControlsViewModel.kt",
    "src/main/java/org/oppia/app/administratorcontrols/appversion/AppVersionViewModel.kt",
    "src/main/java/org/oppia/app/completedstorylist/CompletedStoryItemViewModel.kt",
    "src/main/java/org/oppia/app/completedstorylist/CompletedStoryListViewModel.kt",
    "src/main/java/org/oppia/app/drawer/NavigationDrawerFooterViewModel.kt",
    "src/main/java/org/oppia/app/drawer/NavigationDrawerHeaderViewModel.kt",
    "src/main/java/org/oppia/app/help/faq/faqItemViewModel/FAQContentViewModel.kt",
    "src/main/java/org/oppia/app/help/faq/faqItemViewModel/FAQHeaderViewModel.kt",
    "src/main/java/org/oppia/app/help/faq/faqItemViewModel/FAQItemViewModel.kt",
    "src/main/java/org/oppia/app/help/HelpItems.kt",
    "src/main/java/org/oppia/app/hintsandsolution/HintsAndSolutionItemViewModel.kt",
    "src/main/java/org/oppia/app/hintsandsolution/HintsViewModel.kt",
    "src/main/java/org/oppia/app/hintsandsolution/SolutionViewModel.kt",
    "src/main/java/org/oppia/app/home/HomeItemViewModel.kt",
    "src/main/java/org/oppia/app/home/recentlyplayed/OngoingStoryViewModel.kt",
    "src/main/java/org/oppia/app/home/recentlyplayed/RecentlyPlayedItemViewModel.kt",
    "src/main/java/org/oppia/app/home/recentlyplayed/SectionTitleViewModel.kt",
    "src/main/java/org/oppia/app/home/topiclist/AllTopicsViewModel.kt",
    "src/main/java/org/oppia/app/home/topiclist/PromotedStoryListViewModel.kt",
    "src/main/java/org/oppia/app/home/topiclist/PromotedStoryViewModel.kt",
    "src/main/java/org/oppia/app/home/topiclist/TopicSummaryViewModel.kt",
    "src/main/java/org/oppia/app/home/UserAppHistoryViewModel.kt",
    "src/main/java/org/oppia/app/home/WelcomeViewModel.kt",
    "src/main/java/org/oppia/app/onboarding/OnboardingSlideFinalViewModel.kt",
    "src/main/java/org/oppia/app/onboarding/ViewPagerSlide.kt",
    "src/main/java/org/oppia/app/ongoingtopiclist/OngoingTopicItemViewModel.kt",
    "src/main/java/org/oppia/app/ongoingtopiclist/OngoingTopicListViewModel.kt",
    "src/main/java/org/oppia/app/options/OptionControlsViewModel.kt",
    "src/main/java/org/oppia/app/options/OptionsAppLanguageViewModel.kt",
    "src/main/java/org/oppia/app/options/OptionsAudioLanguageViewModel.kt",
    "src/main/java/org/oppia/app/options/OptionsItemViewModel.kt",
    "src/main/java/org/oppia/app/options/OptionsStoryTextViewViewModel.kt",
    "src/main/java/org/oppia/app/player/audio/AudioViewModel.kt",
    "src/main/java/org/oppia/app/player/exploration/ExplorationViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/ContentViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/ContinueInteractionViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/ContinueNavigationButtonViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/DragAndDropSortInteractionViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/DragDropInteractionContentViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/FeedbackViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/NextButtonViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/NumericInputViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/PreviousButtonViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/PreviousResponsesHeaderViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/ReplayButtonViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/ReturnToTopicButtonViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/SelectionInteractionContentViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/SelectionInteractionViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/StateItemViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/SubmitButtonViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/SubmittedAnswerViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/TextInputViewModel.kt",
    "src/main/java/org/oppia/app/player/state/StateViewModel.kt",
    "src/main/java/org/oppia/app/player/state/testing/StateFragmentTestViewModel.kt",
    "src/main/java/org/oppia/app/profile/AddProfileViewModel.kt",
    "src/main/java/org/oppia/app/profile/AdminAuthViewModel.kt",
    "src/main/java/org/oppia/app/profile/AdminPinViewModel.kt",
    "src/main/java/org/oppia/app/profile/AdminSettingsViewModel.kt",
    "src/main/java/org/oppia/app/profile/PinPasswordViewModel.kt",
    "src/main/java/org/oppia/app/profile/ProfileChooserViewModel.kt",
    "src/main/java/org/oppia/app/profile/ResetPinViewModel.kt",
    "src/main/java/org/oppia/app/profileprogress/ProfilePictureActivityViewModel.kt",
    "src/main/java/org/oppia/app/profileprogress/ProfileProgressHeaderViewModel.kt",
    "src/main/java/org/oppia/app/profileprogress/ProfileProgressItemViewModel.kt",
    "src/main/java/org/oppia/app/profileprogress/ProfileProgressViewModel.kt",
    "src/main/java/org/oppia/app/profileprogress/RecentlyPlayedStorySummaryViewModel.kt",
    "src/main/java/org/oppia/app/recyclerview/BindableAdapter.kt",
    "src/main/java/org/oppia/app/recyclerview/DividerItemDecorator.kt",
    "src/main/java/org/oppia/app/recyclerview/DragAndDropItemFacilitator.kt",
    "src/main/java/org/oppia/app/settings/profile/ProfileEditViewModel.kt",
    "src/main/java/org/oppia/app/settings/profile/ProfileListViewModel.kt",
    "src/main/java/org/oppia/app/settings/profile/ProfileRenameViewModel.kt",
    "src/main/java/org/oppia/app/settings/profile/ProfileResetPinViewModel.kt",
    "src/main/java/org/oppia/app/shim/IntentFactoryShim.kt",
    "src/main/java/org/oppia/app/story/StoryFragmentScroller.kt",
    "src/main/java/org/oppia/app/story/storyitemviewmodel/StoryChapterSummaryViewModel.kt",
    "src/main/java/org/oppia/app/story/storyitemviewmodel/StoryHeaderViewModel.kt",
    "src/main/java/org/oppia/app/story/storyitemviewmodel/StoryItemViewModel.kt",
    "src/main/java/org/oppia/app/story/StoryViewModel.kt",
    "src/main/java/org/oppia/app/testing/BindableAdapterTestViewModel.kt",
    "src/main/java/org/oppia/app/topic/conceptcard/ConceptCardViewModel.kt",
    "src/main/java/org/oppia/app/topic/lessons/StorySummaryViewModel.kt",
    "src/main/java/org/oppia/app/topic/lessons/TopicLessonsItemViewModel.kt",
    "src/main/java/org/oppia/app/topic/lessons/TopicLessonsTitleViewModel.kt",
    "src/main/java/org/oppia/app/topic/practice/practiceitemviewmodel/TopicPracticeFooterViewModel.kt",
    "src/main/java/org/oppia/app/topic/practice/practiceitemviewmodel/TopicPracticeHeaderViewModel.kt",
    "src/main/java/org/oppia/app/topic/practice/practiceitemviewmodel/TopicPracticeItemViewModel.kt",
    "src/main/java/org/oppia/app/topic/practice/practiceitemviewmodel/TopicPracticeSubtopicViewModel.kt",
    "src/main/java/org/oppia/app/topic/practice/TopicPracticeViewModel.kt",
    "src/main/java/org/oppia/app/topic/questionplayer/QuestionPlayerViewModel.kt",
    "src/main/java/org/oppia/app/topic/revision/revisionitemviewmodel/TopicRevisionItemViewModel.kt",
    "src/main/java/org/oppia/app/topic/revision/TopicRevisionViewModel.kt",
    "src/main/java/org/oppia/app/topic/revisioncard/RevisionCardViewModel.kt",
    "src/main/java/org/oppia/app/topic/TopicViewModel.kt",
    "src/main/java/org/oppia/app/viewmodel/ObservableArrayList.kt",
    "src/main/java/org/oppia/app/viewmodel/ObservableViewModel.kt",
    "src/main/java/org/oppia/app/walkthrough/end/WalkthroughFinalViewModel.kt",
    "src/main/java/org/oppia/app/walkthrough/topiclist/topiclistviewmodel/WalkthroughTopicHeaderViewModel.kt",
    "src/main/java/org/oppia/app/walkthrough/topiclist/topiclistviewmodel/WalkthroughTopicSummaryViewModel.kt",
    "src/main/java/org/oppia/app/walkthrough/topiclist/WalkthroughTopicItemViewModel.kt",
    "src/main/java/org/oppia/app/walkthrough/topiclist/WalkthroughTopicViewModel.kt",
    "src/main/java/org/oppia/app/walkthrough/WalkthroughViewModel.kt",
    "src/main/java/org/oppia/app/walkthrough/welcome/WalkthroughWelcomeViewModel.kt",
]

# TODO(#1617): Remove genrules post-gradle
# Files altered by genrules to be excluded in the app library
ALTERED_VIEW_MODELS = [
    "src/main/java/org/oppia/app/administratorcontrols/administratorcontrolsitemviewmodel/AdministratorControlsAccountActionsViewModel.kt",
    "src/main/java/org/oppia/app/help/faq/FAQListViewModel.kt",
    "src/main/java/org/oppia/app/help/HelpItemViewModel.kt",
    "src/main/java/org/oppia/app/help/HelpListViewModel.kt",
    "src/main/java/org/oppia/app/onboarding/OnboadingSlideViewModel.kt",
    "src/main/java/org/oppia/app/onboarding/OnboardingViewModel.kt",
    "src/main/java/org/oppia/app/parser/StringToFractionParser.kt",
    "src/main/java/org/oppia/app/parser/StringToNumberParser.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/FractionInteractionViewModel.kt",
    "src/main/java/org/oppia/app/player/state/itemviewmodel/ImageRegionSelectionInteractionViewModel.kt",
    "src/main/java/org/oppia/app/topic/info/TopicInfoViewModel.kt",
]

[VIEW_MODELS.append("update_" + altered_view_models[0:-3])
for altered_view_models in ALTERED_VIEW_MODELS]

# TODO(#1617): Remove genrules post-gradle
'''
Genrule for source files in the view_models library.

Because each databinding library must have a unique package name and manifest, resources must be
imported using the proper package name when building with Bazel. This genrule alters those imports
in order to keep Gradle building.
'''
[genrule(
    name = "update_" + file[0:-3],
    srcs = [file],
    outs = [file[0:-3] + "_updated.kt"],
    cmd = '''
    cat $(SRCS) |
    sed 's/import org.oppia.app.R/import org.oppia.app.view.models.R/g' > $(OUTS)
    ''',
)
for file in ALTERED_VIEW_MODELS]

# Source files and genrule targets for views library.
VIEWS = [
    "src/main/java/org/oppia/app/customview/interaction/FractionInputInteractionView.kt",
    "src/main/java/org/oppia/app/customview/interaction/NumericInputInteractionView.kt",
    "src/main/java/org/oppia/app/customview/interaction/TextInputInteractionView.kt",
    "src/main/java/org/oppia/app/player/state/DragDropSortInteractionView.kt",
    "src/main/java/org/oppia/app/player/state/ImageRegionSelectionInteractionView.kt",
    "src/main/java/org/oppia/app/player/state/SelectionInteractionView.kt",
    "src/main/java/org/oppia/app/shim/ViewBindingShim.kt",
    "src/main/java/org/oppia/app/shim/ViewComponentFactory.kt",
    "src/main/java/org/oppia/app/view/ViewComponent.kt",
    "src/main/java/org/oppia/app/view/ViewScope.kt",
]

# TODO(#1617): Remove genrules post-gradle
# View files altered by genrules to be excluded in the app library.
ALTERED_VIEWS = [
    "src/main/java/org/oppia/app/customview/LessonThumbnailImageView.kt",
    "src/main/java/org/oppia/app/customview/SegmentedCircularProgressView.kt",
    "src/main/java/org/oppia/app/profile/ProfileInputView.kt",
    "src/main/java/org/oppia/app/utility/ClickableAreasImage.kt",
]

[VIEWS.append("update_" + altered_views[0:-3])
for altered_views in ALTERED_VIEWS]

# TODO(#1617): Remove genrules post-gradle
'''
Genrule for source files in the views library.

Because each databinding library must have a unique package name and manifest, resources must be
imported using the proper package name when building with Bazel. This genrule alters those imports
in order to keep Gradle building.
'''
[genrule(
     name = "update_" + file[0:-3],
     srcs = [file],
     outs = [file[0:-3] + "_updated.kt"],
     cmd = '''
     cat $(SRCS) |
     sed 's/import org.oppia.app.R/import org.oppia.app.views.R/g' > $(OUTS)
     ''',
 )
for file in ALTERED_VIEWS]

# Source files and genrule targets for databinding_adapters library.
DATABINDING_ADAPTERS = [
    "src/main/java/org/oppia/app/databinding/EditTextBindingAdapters.java",
    "src/main/java/org/oppia/app/databinding/GuidelineBindingAdapters.java",
    "src/main/java/org/oppia/app/databinding/MarginBindingAdapters.java",
    "src/main/java/org/oppia/app/databinding/StateAssemblerMarginBindingAdapters.java",
    "src/main/java/org/oppia/app/databinding/StateAssemblerPaddingBindingAdapters.java",
    "src/main/java/org/oppia/app/databinding/ViewBindingAdapters.java",
]

# TODO(#1617): Remove genrules post-gradle
# Adapter files altered by genrules to be excluded in the app library.
ALTERED_DATABINDING_ADAPTERS = [
    "src/main/java/org/oppia/app/databinding/DrawableBindingAdapters.java",
    "src/main/java/org/oppia/app/databinding/ImageViewBindingAdapters.java",
    "src/main/java/org/oppia/app/databinding/TextViewBindingAdapters.java",
]

[DATABINDING_ADAPTERS.append("update_" + altered_adapters[0:-5])
for altered_adapters in ALTERED_DATABINDING_ADAPTERS]

# TODO(#1617): Remove genrules post-gradle
'''
Genrule for source files in the databinding_adapters library.

Because each databinding library must have a unique package name and manifest, resources must be
imported using the proper package name when building with Bazel. This genrule alters those imports
in order to keep Gradle building.
'''
[genrule(
     name = "update_" + file[0:-5],
     srcs = [file],
     outs = [file[0:-5] + "_updated.java"],
     cmd = '''
     cat $(SRCS) |
     sed 's/import org.oppia.app.R/import org.oppia.app.databinding.adapters.R/g' |
     sed 's/BindingAdapters {/BindingAdapters_updated {/g' > $(OUTS)
     ''',
 )
for file in ALTERED_DATABINDING_ADAPTERS]

# Source files for recyclerview_adapters library.
RECYCLERVIEW_ADAPTERS = [
    "src/main/java/org/oppia/app/recyclerview/RecyclerViewBindingAdapter.java"
]

ADAPTERS = DATABINDING_ADAPTERS + RECYCLERVIEW_ADAPTERS + ALTERED_DATABINDING_ADAPTERS

EXCLUDED_APP_LIB_FILES = VIEW_MODELS + ALTERED_VIEW_MODELS + VIEWS + ALTERED_VIEWS + ADAPTERS + LISTENERS + ANNOTATIONS

GENRULE_APP_FILES = glob(["src/main/java/org/oppia/app/**/*.kt"], exclude = EXCLUDED_APP_LIB_FILES)

APP_FILES = []

'''
Genrule that alters both resource import statements and class names for adapter files in order to
account for altered package and file name.
'''
[genrule(
     name = "update_" + file[0:-3],
     srcs = [file[0:-3] + ".kt"],
     outs = [file[0:-3] + "_updated.kt"],
     cmd = '''
     cat $(SRCS) |
     sed 's/import org.oppia.app.R/import org.oppia.app.ui.R/g' |
     sed 's/import org.oppia.app.databinding./import org.oppia.app.databinding.databinding./g' > $(OUTS)
     ''',
 )
for file in GENRULE_APP_FILES]

[APP_FILES.append("update_" + file[0:-3]) for file in GENRULE_APP_FILES]

# Library for non-layout resource files
android_library(
    name = "resources",
    custom_package = "org.oppia.app",
    manifest = "src/main/AndroidManifest.xml",
    resource_files = glob(["src/main/res/**",], exclude = LAYOUTS),
    exports_manifest = True,
    deps = [
        artifact("com.google.android.material:material"),
    ],
    visibility = ["//visibility:private"],
)

# Library for layout resource files
android_library(
    name = "databinding_resources",
    custom_package = "org.oppia.app.databinding",
    manifest = "src/main/DatabindingResourcesManifest.xml",
    srcs = ADAPTERS,
    resource_files = glob(LAYOUTS),
    enable_data_binding = 1,
    exports_manifest = True,
    deps = [
        ":annotations",
        ":databinding_adapters",
        ":recyclerview_adapters",
        ":resources",
        ":view_models",
        ":views",
        "//model",
        "@circularimageview//circularimageview:circular_image_view",
        artifact("androidx.annotation:annotation"),
        artifact("androidx.constraintlayout:constraintlayout"),
        artifact("androidx.core:core:1.0.1"),
        artifact("androidx.databinding:databinding-adapters"),
        artifact("androidx.databinding:databinding-common"),
        artifact("androidx.databinding:databinding-runtime"),
        artifact("androidx.lifecycle:lifecycle-livedata-core:jar:2.0.0-alpha1"),
        artifact("androidx.recyclerview:recyclerview:1.0.0"),
        artifact("androidx.viewpager:viewpager:1.0.0"),
        artifact("com.chaos.view:pinview:1.4.3"),
        artifact("com.google.android.material:material"),
        artifact("de.hdodenhof:circleimageview:3.0.1"),
        artifact("javax.annotation:javax.annotation-api"),
    ],
)

# Library for listener files required to build views and view_model libraries
kt_android_library(
    name = "listeners",
    custom_package = "org.oppia.app",
    srcs = LISTENERS,
    deps = [
        "//model",
        ":dagger",
        artifact("androidx.recyclerview:recyclerview:1.0.0"),
    ],
    visibility = ["//visibility:private"],
)

# Library for all view files required to build layout files
kt_android_library(
    name = "views",
    custom_package = "org.oppia.app.views",
    manifest = "src/main/ViewsManifest.xml",
    srcs = VIEWS,
    deps = [
        ":annotations",
        ":listeners",
        ":resources",
        ":view_models",
        "//model",
        "@circularimageview//circularimageview:circular_image_view",
        artifact("androidx.appcompat:appcompat"),
        artifact("androidx.core:core-ktx"),
    ],
    visibility = ["//visibility:private"],
)

# Library for scope annotations required to build views and view_model libraries
kt_android_library(
    name = "annotations",
    custom_package = "org.oppia.app",
    srcs = ANNOTATIONS,
    deps = [
        "//model",
        ":dagger",
    ],
    visibility = ["//visibility:private"],
)

# Library for all view model files
kt_android_library(
    name = "view_models",
    custom_package = "org.oppia.app.view.models",
    srcs = VIEW_MODELS,
    enable_data_binding = 1,
    manifest = "src/main/ViewModelsManifest.xml",
    deps = [
        ":annotations",
        ":dagger",
        ":listeners",
        ":resources",
        "//domain",
        "//model",
        "//utility",
        artifact("androidx.databinding:databinding-runtime"),
        artifact("androidx.databinding:databinding-common"),
    ],
    visibility = ["//visibility:private"],
)

# TODO(#1639): Translate binding adapters back to Kotlin post-Bazel modularization.
# Library for all custom data-binding adapters under org/oppia/app/databinding
android_library(
    name = "databinding_adapters",
    custom_package = "org.oppia.app.databinding.adapters",
    srcs = DATABINDING_ADAPTERS,
    enable_data_binding = 1,
    manifest = "src/main/DatabindingAdaptersManifest.xml",
    deps = [
        ":dagger",
        ":resources",
        ":view_models",
        "//model",
        "//utility",
        "@circularimageview//circularimageview:circular_image_view",
        artifact("androidx.annotation:annotation"),
        artifact("androidx.constraintlayout:constraintlayout:1.1.3"),
    ],
    visibility = ["//visibility:private"],
)

# TODO(#1639): Translate binding adapters back to Kotlin post-Bazel modularization.
# Library for all custom databinding adapters under org/oppia/app/recyclerview
android_library(
    name = "recyclerview_adapters",
    custom_package = "org.oppia.app.recyclerview.adapters",
    srcs = RECYCLERVIEW_ADAPTERS,
    enable_data_binding = 1,
    manifest = "src/main/RecyclerviewAdaptersManifest.xml",
    deps = [
        ":dagger",
        ":view_models",
        "//model",
        "//utility",
        artifact("androidx.annotation:annotation"),
        artifact("androidx.lifecycle:lifecycle-livedata-core:jar:2.0.0-alpha1"),
        artifact("androidx.lifecycle:lifecycle-livedata-ktx"),
    ],
    visibility = ["//visibility:private"],
)

kt_android_library(
    name = "app",
    custom_package = "org.oppia.app.ui",
    srcs = APP_FILES,
    enable_data_binding = 1,
    manifest = "src/main/AppAndroidManifest.xml",
    deps = [
        "//data",
        "//model",
        "//utility",
        ":dagger",
        ":databinding_adapters",
        ":databinding_resources",
        ":resources",
        ":view_models",
        ":views",
        artifact("androidx.databinding:databinding-adapters"),
        artifact("androidx.databinding:databinding-common"),
        artifact("androidx.databinding:databinding-runtime"),
        artifact("androidx.lifecycle:lifecycle-extensions:2.2.0"),
        artifact("androidx.lifecycle:lifecycle-livedata-core:2.2.0"),
        artifact("androidx.lifecycle:lifecycle-livedata-ktx:2.2.0"),
        artifact("androidx.multidex:multidex:2.0.1"),
        artifact("androidx.viewpager:viewpager:1.0.0"),
        artifact("com.caverock:androidsvg-aar"),
        artifact("javax.annotation:javax.annotation-api:jar"),
        artifact("androidx.navigation:navigation-fragment:2.0.0"),
        artifact("androidx.navigation:navigation-fragment-ktx:2.0.0"),
        artifact("androidx.navigation:navigation-ui:2.0.0"),
        artifact("androidx.navigation:navigation-ui-ktx:2.0.0"),
    ],
    visibility = ["//visibility:public"],
)

kt_android_library(
    name = "test_deps",
    srcs = [
        "src/sharedTest/java/org/oppia/app/utility/OrientationChangeAction.kt",
        "src/sharedTest/java/org/oppia/app/recyclerview/RecyclerViewMatcher.kt",
        "src/sharedTest/java/org/oppia/app/utility/ProgressMatcher.kt",
        "src/sharedTest/java/org/oppia/app/parser/RichTextViewMatcher.kt",
        "src/sharedTest/java/org/oppia/app/utility/DrawableMatcher.kt",
        "src/sharedTest/java/org/oppia/app/utility/EspressoTestsMatchers.kt",
        "src/sharedTest/java/org/oppia/app/utility/TabMatcher.kt",
        "src/sharedTest/java/org/oppia/app/utility/FontSizeMatcher.kt",
        "src/sharedTest/java/org/oppia/app/utility/MockitoKotlinHelper.kt",
        "src/sharedTest/java/org/oppia/app/utility/DragViewAction.kt",
        "src/sharedTest/java/org/oppia/app/utility/ClickActions.kt",
    ],
    deps = [
        ":app",
        "//testing",
        artifact("org.mockito:mockito-core"),
    ]
)

TEST_DEPS = [
    ":app",
    ":dagger",
    "//utility",
    "//testing",
    "//domain",
    "//data",
    ":resources",
    ":test_deps",
    "@robolectric//bazel:android-all",
    artifact("org.jetbrains.kotlin:kotlin-reflect"),
    artifact("com.google.truth:truth"),
    artifact("androidx.test.ext:junit"),
    artifact("androidx.databinding:databinding-runtime"),
    artifact("androidx.databinding:databinding-adapters"),
    artifact("androidx.databinding:databinding-common"),
    artifact("androidx.annotation:annotation"),
    artifact("androidx.databinding:databinding-compiler"),
    artifact("androidx.test:runner:1.2.0"),
    artifact("org.jetbrains.kotlinx:kotlinx-coroutines-test:1.2.2"),
    artifact("org.robolectric:annotations:4.3"),
    artifact("org.mockito:mockito-core"),
    artifact("androidx.test.espresso:espresso-contrib:3.1.0"),
    artifact("androidx.test.espresso:espresso-core:3.2.0"),
    artifact("androidx.test.espresso:espresso-intents:3.1.0"),
]

ALTERED_TESTS = [
    "src/test/java/org/oppia/app/player/state/StateFragmentLocalTest.kt",
    "src/test/java/org/oppia/app/testing/player/state/StateFragmentAccessibilityTest.kt",
    "src/test/java/org/oppia/app/testing/CompletedStoryListSpanTest.kt",
    "src/test/java/org/oppia/app/testing/OngoingTopicListSpanTest.kt",
    "src/test/java/org/oppia/app/testing/TopicRevisionSpanTest.kt",
    "src/sharedTest/java/org/oppia/app/profile/AdminAuthActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/profile/AddProfileActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/walkthrough/WalkthroughWelcomeFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/profile/AdminPinActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/topic/practice/TopicPracticeFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/walkthrough/WalkthroughTopicListFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/administratorcontrols/AppVersionActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/recyclerview/BindableAdapterTest.kt",
    "src/sharedTest/java/org/oppia/app/walkthrough/WalkthroughFinalFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/testing/TopicTestActivityForStoryTest.kt",
    "src/sharedTest/java/org/oppia/app/player/audio/AudioFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/testing/TestFontScaleConfigurationUtilActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/help/HelpFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/topic/conceptcard/ConceptCardFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/testing/DragDropTestActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/settings/profile/ProfileListActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/administratorcontrols/AdministratorControlsActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/options/OptionsFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/settings/profile/ProfileEditActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/profile/ProfileChooserFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/faq/FAQSingleActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/ongoingtopiclist/OngoingTopicListActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/onboarding/OnboardingFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/profile/PinPasswordActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/topic/revision/TopicRevisionFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/parser/HtmlParserTest.kt",
    "src/sharedTest/java/org/oppia/app/profileprogress/ProfileProgressFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/completedstorylist/CompletedStoryListActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/walkthrough/WalkthroughActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/testing/ImageRegionSelectionInteractionViewTest.kt",
    "src/sharedTest/java/org/oppia/app/topic/info/TopicInfoFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/mydownloads/MyDownloadsFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/player/state/StateFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/story/StoryFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/home/RecentlyPlayedFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/faq/FAQListFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/settings/profile/ProfileRenameActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/home/HomeActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/topic/revisioncard/RevisionCardFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/settings/profile/ProfileResetPinActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/splash/SplashActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/story/StoryActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/testing/InputInteractionViewTestActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/testing/NavigationDrawerTestActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/topic/questionplayer/QuestionPlayerActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/profileprogress/ProfilePictureActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/topic/TopicFragmentTest.kt",
    "src/sharedTest/java/org/oppia/app/player/exploration/ExplorationActivityTest.kt",
    "src/sharedTest/java/org/oppia/app/topic/lessons/TopicLessonsFragmentTest.kt",
]

'''
Genrule that alters both resource import statements and class names for adapter files in order to
account for altered package and file name.
'''
[genrule(
     name = "update_" + file[0:-3],
     srcs = [file[0:-3] + ".kt"],
     outs = [file[0:-3] + "_updated.kt"],
     cmd = '''
     cat $(SRCS) |
     sed 's/import org.oppia.app.R/import org.oppia.app.test.R/g' |
     sed 's/import org.oppia.app.databinding./import org.oppia.app.databinding.databinding./g' > $(OUTS)
     ''',
 )
for file in ALTERED_TESTS]

''' App module tests'''

app_test(
    name = "HomeActivityLocalTest",
    srcs = [
        "src/test/java/org/oppia/app/home/HomeActivityLocalTest.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.home.HomeActivityLocalTest",
    deps = TEST_DEPS,
)

# TODO: Test doesn't pass
app_test(
    name = "ExplorationActivityLocalTest",
    srcs = [
        "src/test/java/org/oppia/app/player/exploration/ExplorationActivityLocalTest.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.player.exploration.ExplorationActivityLocalTest",
    deps = TEST_DEPS,
)

app_test(
    name = "StateFragmentLocalTest",
    srcs = [
        "update_src/test/java/org/oppia/app/player/state/StateFragmentLocalTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.player.state.StateFragmentLocalTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfileChooserFragmentLocalTest",
    srcs = [
        "src/test/java/org/oppia/app/profile/ProfileChooserFragmentLocalTest.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.profile.ProfileChooserFragmentLocalTest",
    deps = TEST_DEPS,
)

app_test(
    name = "StoryActivityLocalTest",
    srcs = [
        "src/test/java/org/oppia/app/story/StoryActivityLocalTest.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.story.StoryActivityLocalTest",
    deps = TEST_DEPS,
)

app_test(
    name = "CompletedStoryListSpanTest",
    srcs = [
        "update_src/test/java/org/oppia/app/testing/CompletedStoryListSpanTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.CompletedStoryListSpanTest",
    deps = TEST_DEPS,
)

app_test(
    name = "OngoingTopicListSpanTest",
    srcs = [
        "update_src/test/java/org/oppia/app/testing/OngoingTopicListSpanTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.OngoingTopicListSpanTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfileChooserSpanTest",
    srcs = [
        "src/test/java/org/oppia/app/testing/ProfileChooserSpanTest.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.ProfileChooserSpanTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicRevisionSpanTest",
    srcs = [
        "update_src/test/java/org/oppia/app/testing/TopicRevisionSpanTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.TopicRevisionSpanTest",
    deps = TEST_DEPS,
)

app_test(
    name = "PlayerSplitScreenTesting",
    srcs = [
        "src/test/java/org/oppia/app/testing/player/split/PlayerSplitScreenTesting.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.player.split.PlayerSplitScreenTesting",
    deps = TEST_DEPS,
)

app_test(
    name = "StateFragmentAccessibilityTest",
    srcs = [
        "update_src/test/java/org/oppia/app/testing/player/state/StateFragmentAccessibilityTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.testing.player.state.StateFragmentAccessibilityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicInfoFragmentLocalTest",
    srcs = [
        "src/test/java/org/oppia/app/topic/info/TopicInfoFragmentLocalTest.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.info.TopicInfoFragmentLocalTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicLessonsFragmentLocalTest",
    srcs = [
        "src/test/java/org/oppia/app/topic/lessons/TopicLessonsFragmentLocalTest.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.lessons.TopicLessonsFragmentLocalTest",
    deps = TEST_DEPS,
)

app_test(
    name = "RevisionCardActivityLocalTest",
    srcs = [
        "src/test/java/org/oppia/app/topic/revisioncard/RevisionCardActivityLocalTest.kt",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.revisioncard.RevisionCardActivityLocalTest",
    deps = TEST_DEPS,
)

''' App Module Shared Tests '''

app_test(
    name = "AdministratorControlsActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/administratorcontrols/AdministratorControlsActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.administratorcontrols.AdministratorControlsActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "AppVersionActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/administratorcontrols/AppVersionActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.administratorcontrols.AppVersionActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "CompletedStoryListActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/completedstorylist/CompletedStoryListActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.completedstorylist.CompletedStoryListActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "FAQListFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/faq/FAQListFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.faq.FAQListFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "FAQSingleActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/faq/FAQSingleActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.faq.FAQSingleActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "HelpFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/help/HelpFragmentTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.help.HelpFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "HomeActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/home/HomeActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.home.HomeActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "RecentlyPlayedFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/home/RecentlyPlayedFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.home.RecentlyPlayedFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "MyDownloadsFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/mydownloads/MyDownloadsFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.mydownloads.MyDownloadsFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "OnboardingFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/onboarding/OnboardingFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.onboarding.OnboardingFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "OngoingTopicListActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/ongoingtopiclist/OngoingTopicListActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.ongoingtopiclist.OngoingTopicListActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "OptionsFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/options/OptionsFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.options.OptionsFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "HtmlParserTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/parser/HtmlParserTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.parser.HtmlParserTest",
    deps = TEST_DEPS,
)

app_test(
    name = "AudioFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/player/audio/AudioFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.player.audio.AudioFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ExplorationActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/player/exploration/ExplorationActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.player.exploration.ExplorationActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "StateFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/player/state/StateFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.player.state.StateFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "AddProfileActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/profile/AddProfileActivityTest",
        "src/test/java/DataBinderMapperImpl.java",
        "src/sharedTest/java/org/oppia/app/utility/OrientationChangeAction.kt",
    ],
    test_class = "org.oppia.app.profile.AddProfileActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "AdminAuthActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/profile/AdminAuthActivityTest",
        "src/test/java/DataBinderMapperImpl.java",
        "src/sharedTest/java/org/oppia/app/utility/OrientationChangeAction.kt"
    ],
    test_class = "org.oppia.app.profile.AdminAuthActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "AdminPinActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/profile/AdminPinActivityTest",
        "src/test/java/DataBinderMapperImpl.java",
        "src/sharedTest/java/org/oppia/app/utility/OrientationChangeAction.kt"
    ],
    test_class = "org.oppia.app.profile.AdminPinActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "PinPasswordActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/profile/PinPasswordActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.profile.PinPasswordActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfileChooserFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/profile/ProfileChooserFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.profile.ProfileChooserFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfilePictureActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/profileprogress/ProfilePictureActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.profileprogress.ProfilePictureActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfileProgressFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/profileprogress/ProfileProgressFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.profileprogress.ProfileProgressFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "BindableAdapterTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/recyclerview/BindableAdapterTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.recyclerview.BindableAdapterTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfileEditActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/settings/profile/ProfileEditActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.settings.profile.ProfileEditActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfileListActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/settings/profile/ProfileListActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.settings.profile.ProfileListActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfileRenameActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/settings/profile/ProfileRenameActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.settings.profile.ProfileRenameActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ProfileResetPinActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/settings/profile/ProfileResetPinActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.settings.profile.ProfileResetPinActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "SplashActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/splash/SplashActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.splash.SplashActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "StoryActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/story/StoryActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.story.StoryActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "StoryFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/story/StoryFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.story.StoryFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "DragDropTestActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/testing/DragDropTestActivityTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.testing.DragDropTestActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ImageRegionSelectionInteractionViewTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/testing/ImageRegionSelectionInteractionViewTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.ImageRegionSelectionInteractionViewTest",
    deps = TEST_DEPS,
)

app_test(
    name = "InputInteractionViewTestActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/testing/InputInteractionViewTestActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.InputInteractionViewTestActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "NavigationDrawerTestActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/testing/NavigationDrawerTestActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.NavigationDrawerTestActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TestFontScaleConfigurationUtilActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/testing/TestFontScaleConfigurationUtilActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.testing.TestFontScaleConfigurationUtilActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicTestActivityForStoryTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/testing/TopicTestActivityForStoryTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.testing.TopicTestActivityForStoryTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/topic/TopicFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.TopicFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "ConceptCardFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/topic/conceptcard/ConceptCardFragmentTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.topic.conceptcard.ConceptCardFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicInfoFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/topic/info/TopicInfoFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.info.TopicInfoFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicLessonsFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/topic/lessons/TopicLessonsFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.lessons.TopicLessonsFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicPracticeFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/topic/practice/TopicPracticeFragmentTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.topic.practice.TopicPracticeFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "QuestionPlayerActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/topic/questionplayer/QuestionPlayerActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.questionplayer.QuestionPlayerActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "TopicRevisionFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/topic/revision/TopicRevisionFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.revision.TopicRevisionFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "RevisionCardFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/topic/revisioncard/RevisionCardFragmentTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.topic.revisioncard.RevisionCardFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "WalkthroughActivityTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/walkthrough/WalkthroughActivityTest",
        "src/test/java/DataBinderMapperImpl.java"
    ],
    test_class = "org.oppia.app.walkthrough.WalkthroughActivityTest",
    deps = TEST_DEPS,
)

app_test(
    name = "WalkthroughFinalFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/walkthrough/WalkthroughFinalFragmentTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.walkthrough.WalkthroughFinalFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "WalkthroughTopicListFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/walkthrough/WalkthroughTopicListFragmentTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.walkthrough.WalkthroughTopicListFragmentTest",
    deps = TEST_DEPS,
)

app_test(
    name = "WalkthroughWelcomeFragmentTest",
    srcs = [
        "update_src/sharedTest/java/org/oppia/app/walkthrough/WalkthroughWelcomeFragmentTest",
        "src/test/java/DataBinderMapperImpl.java",
    ],
    test_class = "org.oppia.app.walkthrough.WalkthroughWelcomeFragmentTest",
    deps = TEST_DEPS,
)

# TODO(#1566): Move Firebase rules to their own package & remove default visibility
'''
Package for all Firebase dependencies.
To reference these dependencies, add '//app:crashlytics' and '//app:crashlytics_deps'
to your build rule's dependency list.
'''
package(default_visibility = ["//visibility:public"])

GOOGLE_SERVICES_RESOURCES = google_services_xml(
    package_name = "org.oppia.app",
    google_services_json = "google-services.json",
)

crashlytics_android_library(
    name = "crashlytics",
    package_name = "org.oppia.app",
    build_id = "48fc9d17-e102-444c-8e0d-638d75ec0942",
    resource_files = GOOGLE_SERVICES_RESOURCES,
)

android_library(
    name = "crashlytics_deps",
    exports = [
        artifact("com.crashlytics.sdk.android:crashlytics"),
        artifact("io.fabric.sdk.android:fabric"),
        artifact("com.google.firebase:firebase-analytics"),
        artifact("com.google.firebase:firebase-crashlytics"),
    ],
)

dagger_rules()
